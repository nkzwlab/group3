(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],[,,,,,,function(e,t,a){e.exports=a(13)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(5),i=a.n(o),c=(a(11),a(1)),l=a(3),s=a(2),d=(a(12),function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setUser=function(e){if(console.log("logged in as :",e.login_name),!e.login_name||!e.id)throw"invalid user data";n.setState({loggedIn:!0,user:{loginName:e.login_name,id:e.id}})},n.login=function(e){var t="http://localhost:8080/user?login_name=".concat(e);fetch(t).then((function(e){return e.json()})).then(n.setUser).catch((function(t){console.log(t);var a="http://localhost:8080/user/new?login_name=".concat(e);return fetch(a,{method:"POST",headers:new Headers({Accept:"application/json"})})})).then((function(e){return e.json()})).then(n.setUser).catch((function(e){return console.log("error!: ",e)}))},n.render=function(){var e=n.state.loggedIn?r.a.createElement("div",{className:"mainContent"},r.a.createElement(h,{user:n.state.user})):r.a.createElement(u,{onLogin:n.login,onSubmit:n.login});return r.a.createElement("div",{className:"App"},r.a.createElement("h1",{className:"pageHeader"},"\u8ab2\u984c\u7ba1\u7406\u30b5\u30fc\u30d3\u30b9"),e)},n.state={loggedIn:!1},n}return a}(r.a.Component)),u=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=e.target.value;n.setState({loginName:t})},n.handleSubmit=function(e){n.props.onSubmit(n.state.loginName),e.preventDefault()},n.render=function(){return r.a.createElement("form",{className:"loginForm",onSubmit:n.handleSubmit},r.a.createElement("input",{type:"text",value:n.state.loginName,onChange:n.handleChange}),r.a.createElement("input",{type:"submit",value:"\u30ed\u30b0\u30a4\u30f3"}))},n.state={loginName:""},n}return a}(r.a.Component),h=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).refreshKadais=function(){console.log("refresh");var e="http://localhost:8080/kadai?user_id=".concat(n.props.user.id);fetch(e).then((function(e){return e.json()})).then(n.setKadais).catch((function(e){return console.log(e)}))},n.setKadais=function(e){if(null!==e&&void 0!==e){var t=e.map((function(e){return{id:e.id,userId:e.user_id,title:e.title,content:e.content,draft:e.draft,editing:!1}}));n.setState({kadais:t})}else n.setState({kadais:[]})},n.editKadai=function(e){var t=n.state.kadais.map((function(t){return t.id===e.id&&(t.editing=!0),t}));n.setState(t)},n.updateDone=function(e){var t="http://localhost:8080/kadai/done?kadai_id=".concat(e);(new URLSearchParams).append("kadai_id",e),fetch(t,{method:"POST"}).then((function(e){return alert("done!")})).catch((function(e){console.error("error!: ",e)})).finally((function(){n.refreshKadais()}))},n.render=function(){var e=n.state.kadais.map((function(e){return r.a.createElement(p,{user:n.props.user,key:e.id,kadai:e,onDone:n.updateDone,refresh:n.refreshKadais,editing:e.editing})}));return r.a.createElement("div",null,r.a.createElement("h2",null,"\u672a\u63d0\u51fa\u8ab2\u984c\u4e00\u89a7"),r.a.createElement("button",{onClick:n.refreshKadais},"\u518d\u8aad\u307f\u8fbc\u307f"),e,r.a.createElement("h2",null,"\u65b0\u3057\u3044\u8ab2\u984c\u3092\u767b\u9332\u3059\u308b"),r.a.createElement(v,{refresh:n.refreshKadais,user:n.props.user}))},n.refreshKadais(),n.state={kadais:[]},n}return a}(r.a.Component),p=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).startEdit=function(e){console.log("edit started");var t=n.state.kadai;t.editing=!0,n.setState({kadai:t})},n.finishEdit=function(e){console.log("edit finished"),e.editing=!1,n.setState({kadai:e})},n.handleDone=function(e){n.props.onDone(n.state.kadai.id),n.props.refresh()},n.render=function(){var e=n.state.kadai,t=e.editing?r.a.createElement(g,{kadai:e,finishEdit:n.finishEdit,refresh:n.props.refresh}):r.a.createElement(f,{kadai:e,handleEdit:n.startEdit,handleDone:n.handleDone});return r.a.createElement("div",{className:"kadaiItem"},t)},n.state={kadai:n.props.kadai},n}return a}(r.a.Component),f=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).render=function(){return r.a.createElement("div",null,r.a.createElement("h3",{className:"kadaiTitle"},n.kadai.title),r.a.createElement("ul",null,r.a.createElement("li",null,"\u8ab2\u984c\u5185\u5bb9:",r.a.createElement("p",{className:"kadaiBody"},n.kadai.content)),r.a.createElement("li",null," \u4e0b\u66f8\u304d:",r.a.createElement("p",{className:"kadaiBody"},n.kadai.draft))),r.a.createElement("button",{className:"edit",onClick:n.props.handleEdit},"\u7de8\u96c6"),r.a.createElement("button",{className:"done",onClick:n.props.handleDone},"\u63d0\u51fa\u5b8c\u4e86"))},n.kadai=n.props.kadai,n}return a}(r.a.Component),m=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){n.props.onSubmit(n.state.kadai),n.setState({kadai:{title:"",content:"",draft:""}}),e.preventDefault()},n.handleChange=function(e,t){var a=n.state.kadai;a[e]=t,n.setState({kadai:a})},n.render=function(){var e=n.state.kadai;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:n.handleSubmit},r.a.createElement("ul",null,r.a.createElement(k,{type:"title",value:e.title,changeHandler:n.handleChange}),r.a.createElement(k,{type:"content",value:e.content,changeHandler:n.handleChange}),r.a.createElement(k,{type:"draft",value:e.draft,changeHandler:n.handleChange}),r.a.createElement("input",{type:"submit",value:"\u5b8c\u4e86"}))))},n.state={kadai:n.props.kadai},n}return a}(r.a.Component),g=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).updateKadai=function(e){var t=new URLSearchParams;t.set("kadai_id",e.id),t.set("title",e.title),t.set("content",e.content),t.set("draft",e.draft),fetch("http://localhost:8080/kadai/update?"+t.toString(),{method:"POST",headers:new Headers({Accept:"application/json"}),body:t}).then((function(e){return e.json()})).then((function(e){e.error?alert(e.error):console.log(e)})).catch((function(e){console.log("error!: ",e)})).finally((function(){n.props.finishEdit(e),console.log("end"),n.props.refresh()}))},n.render=function(){return r.a.createElement(m,{kadai:n.kadai,onSubmit:n.updateKadai})},n.kadai=n.props.kadai,n}return a}(r.a.Component),v=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).postNewKadai=function(e){var t=new URLSearchParams;t.append("user_id",n.user.id),t.append("title",e.title),t.append("content",e.content),t.append("draft",e.draft),fetch("http://localhost:8080/kadai/new",{method:"POST",headers:new Headers({Accept:"application/json"}),body:t}).then((function(e){return e.json()})).then((function(e){e.error&&console.error(e.error),console.log(e),n.props.refresh()})).catch((function(e){return console.error("error!: ",e)}))},n.render=function(){return r.a.createElement(m,{kadai:n.kadai,onSubmit:n.postNewKadai})},n.kadai={user_id:n.props.user.id,title:"",content:"",draft:"",editing:!0},n.user=n.props.user,n}return a}(r.a.Component),k=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).handleChange=function(t){e.props.changeHandler(e.props.type,t.target.value),t.preventDefault()},e.render=function(){var t=e.props.type,a={title:"\u8ab2\u984c\u540d",content:"\u8ab2\u984c\u5185\u5bb9",draft:"\u4e0b\u66f8\u304d"}[t],n="title"===t?r.a.createElement("input",{type:"text",value:e.props.value,onChange:e.handleChange,className:"kadaiEditTitle"}):r.a.createElement("textarea",{type:"text",value:e.props.value,onChange:e.handleChange,className:"kadaiEditBody"});return r.a.createElement("li",null,r.a.createElement("p",null,a),n)},e}return a}(r.a.Component),E=d;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[6,1,2]]]);
//# sourceMappingURL=main.bf6b39ad.chunk.js.map